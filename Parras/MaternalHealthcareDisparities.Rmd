---
title: "EDA Maternal Healthcare Disparities"
output: html_document
date: "2024-06-07"
---

```{r setup, include=FALSE}

```

## Overview of the Dataset 
The dataset that we were given was maternal healthcare disparities. It is
a sample of data from the CDC database for birth records from 2019. It includes details such as the number of prior births now deceased, maternal tobacco use, and whether the mother had pre-pregnancy diabetes or hypertension. This dataset provides statistics for births, including the average age of the mother, average birth weight, average pre-pregnancy BMI, average number of prenatal visits, and the average interval since the last birth. This data allows for analysis of maternal and infant health trends across different states. It offers us valuable insights into the impacts of these factors on birth outcomes.


```{r}
library(tidyverse)
maternal <- read_csv("https://raw.githubusercontent.com/36-SURE/36-SURE.github.io/main/data/maternal.csv")

```

## Question 1: 
Is higher maternal age associated with higher prenatal visits? To look at the relationship between these two variables, we can use a scatterplot. 

```{r}
maternal %>%  
  ggplot(aes(x=AverageMotherAge, y=AverageNumberPrenatalVisits)) +
  geom_point(color="lightpink",size=3,alpha=0.5) +
  theme_minimal() 
# adding a linear regression line 
maternal %>% 
  ggplot(aes(x = AverageMotherAge, y = AverageNumberPrenatalVisits)) +
  geom_point(color = "lightpink", size = 3, alpha = 0.5) +
  geom_smooth(method = "lm", linewidth = 2, color="hotpink")
```

The graphs show that there seems to be some positive relationship between the Average Mother Age and Average Prenatal Visits. More convincing proof would be to check the correlation coefficient. 

```{r}
cor(maternal$AverageMotherAge, 
    maternal$AverageNumberPrenatalVisits, 
    use = "complete.obs")
```
Now looking at the same data but with clustering with kmeans to see any other significant findings. 

```{r}
clean_data <- maternal %>%  
  select(AverageMotherAge, AverageNumberPrenatalVisits) %>%
  na.omit()

init_kmeans <- clean_data %>%  
  kmeans(centers = 5, nstart = 1, algorithm = "Lloyd")

clean_data <- clean_data %>%
  mutate(clusters = as.factor(init_kmeans$cluster))

clean_data %>%
  ggplot(aes(x = AverageMotherAge, y = AverageNumberPrenatalVisits, color = clusters)) +
  geom_point() + 
  labs(title = "Clustering" ,
       x = "Average Mother Age",
       y = "Average Number of Prenatal Visits") +
  coord_fixed()

ggplot(clean_data, aes(x = clusters, y = AverageNumberPrenatalVisits, color = clusters)) +
  geom_boxplot() +
  labs(x = "Cluster", y = "Average Prenantal Visits") +
  theme_minimal()

ggplot(clean_data, aes(x = clusters, y = AverageMotherAge, color = clusters)) +
  geom_boxplot() +
  labs(x = "Cluster", y = "Average Mother Age") +
  theme_minimal()

```

## Question 2: 
What is the affect of diabetes and tobacco use on birth weight? Is there a similarity?  

```{r}


```

## Question 3: 

